sam depoly

1.Cloudformation -> stack å †æ ˆ -> sam depoly æŒ‡å®šåå­— -> ä¿å­˜åˆ°ä½ æœ¬åœ° 2.åˆ†é…çš„èµ„æºå°±æ˜¯ Serverless -> lambda
NestjsFunction -> Handler: lambda.handler -> NodeModulesLayer 2.ç»§ç»­åˆ†é…çš„èµ„æº api-getway
Api -> Path: /{proxy+} -> Method: ANY -> Integration: lambda
sam çš„é…ç½®æ–‡ä»¶é‡Œå¼€å¯
BinaryMediaTypes:

- 'image/\*'
- 'multipart/form-data'
  3.StageName: dev é€‰æ‹©å¯¹åº”çš„é˜¶æ®µ + https çš„è¯ä¹¦
  4.route53 ç»‘å®šåŸŸå

node.js -> å¯¹å¤–å¯¹å¤–è®¿é—®çš„
-> è®¿é—®æ•°æ®åº“ 0.0.0.0 å¯¹å¤–è®¿é—®çš„

åŒä¸€ä¸ª VPC ä¸‹

5.æ ¸å¿ƒæ¦‚å¿µ
5-1.ä»€ä¹ˆæ˜¯ VPC?
åˆ›å»ºæ•°æ®åº“çš„æ—¶å€™ æœ‰ä¸€ä¸ªé€‰é¡¹å°±æ˜¯ VPC é»˜è®¤çš„
VPCï¼ˆVirtual Private Cloudï¼Œè™šæ‹Ÿç§æœ‰äº‘ï¼‰ï¼Œå¯ä»¥ç†è§£ä¸ºï¼š
ğŸ‘‰ ä½ åœ¨å…¬æœ‰äº‘é‡Œâ€œè‡ªå·±å•ç‹¬çš„ä¸€å¼ å†…ç½‘ + ç§æœ‰æœºæˆ¿â€ã€‚

5-2.ä»€ä¹ˆæ˜¯å­ç½‘ subnet?
å­ç½‘ï¼ˆSubnetï¼‰æœ¬è´¨ä¸Šå°±æ˜¯ï¼šæŠŠä¸€ä¸ªå¤§çš„ç½‘ç»œï¼ˆVPC çš„ IP æ®µï¼‰
åˆ‡æˆæ›´å°çš„â€œç½‘ç»œåˆ†åŒºâ€ï¼Œæ¯ä¸ªåˆ†åŒºé‡Œæ”¾ä¸€æ‰¹èµ„æºï¼ˆEC2ã€RDSã€EKS èŠ‚ç‚¹ã€NATã€ALBâ€¦ï¼‰ï¼Œ
åˆ†ä¸º å…¬æœ‰å­ç½‘ï¼ˆPublic Subnetï¼‰ å’Œ ç§æœ‰å­ç½‘
koa èº²åœ¨ ç§æœ‰ --> 3 ä¸ªç§æœ‰å­ç½‘
ï¼Ÿï¼Ÿkoa è®¿é—®å¤–éƒ¨çš„ç½‘ç»œ 1 ä¸ªå…±æœ‰å­ç½‘å¯¹å¤–

5-3.ç§æœ‰å­ç½‘è®¿é—®å…¬ç½‘éœ€è¦ä»€ä¹ˆå‘¢ï¼Ÿ
Internet Gatewayï¼ˆIGWï¼‰
è®©å­ç½‘é‡Œçš„èµ„æºâ€œç›´æ¥è¿å…¬ç½‘â€çš„ç½‘å…³ï¼Œèµ„æºå¿…é¡»æœ‰å…¬ç½‘ IPï¼ˆå¼¹æ€§å…¬ç½‘ ipï¼‰ï¼Œå…¬ç½‘ä¹Ÿèƒ½ä¸»åŠ¨è®¿é—®å®ƒã€‚
NAT Gateway
è®©ç§æœ‰å­ç½‘é‡Œçš„èµ„æºâ€œåªå‡ºä¸è¿›â€è®¿é—®å…¬ç½‘ï¼Œå¯¹å¤–ç»Ÿä¸€ç”¨ NAT çš„å…¬ç½‘ IPã€‚ 6.å®‰å…¨ç»„
åˆ›å»ºæ•°æ®åº“çš„æ—¶å€™ å®‰å…¨ç»„çš„ iD + vpc çš„ ID å¿…é¡»ä¸€è‡´
7.role è®¿é—®æ•°æ®åº“ + IAM æƒé™é…ç½® S3 è§’è‰²é…ç»™åº”ç”¨ -> role -> é€šè¿‡ iam é…ç½® -> arn(å…·ä½“èµ„æº) 8.è·¯ç”±è¡¨ï¼ˆRoute Tableï¼‰
å†³å®š æµé‡æ€ä¹ˆèµ°ï¼š
â€¢ å»å…¬ç½‘ï¼Ÿèµ° Internet Gateway
â€¢ ç§æœ‰å­ç½‘å‡ºç½‘ï¼Ÿèµ° NAT Gateway
â€¢ å†…ç½‘äº’é€šï¼Ÿæœ¬åœ°è·¯ç”±

[Internet](è·¯ç”±è¡¨)
|
[ IGW ]
|
[ å…¬æœ‰å­ç½‘ ]
â””â”€ Bastionï¼ˆè·³æ¿æœºï¼‰
|
[ ç§æœ‰å­ç½‘ ]
â”œâ”€ API æœåŠ¡
â”œâ”€ AI Agent / æ¨ç†æœåŠ¡
â””â”€ æ•°æ®åº“ / åŒºå—é“¾èŠ‚ç‚¹
|
[ NAT Gateway ] â†’ å‡ºç½‘æ‹‰ä¾èµ–

                         Internet
                            â”‚
                            â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚      IGW      â”‚  (Internet Gateway)
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚               â”‚               â”‚
            â–¼               â–¼               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                      VPC                       â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  â”‚         å…¬æœ‰å­ç½‘ (Public Subnet)         â”‚  â”‚
    â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚  â”‚
    â”‚  â”‚    â”‚ NAT Gateway â”‚ â—„â”€â”€ æœ‰å…¬ç½‘ IP        â”‚  â”‚
    â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚  â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                     â”‚                         â”‚
    â”‚                     â–¼                         â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  â”‚       ç§æœ‰å­ç½‘ (Private Subnets)         â”‚  â”‚
    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”           â”‚  â”‚
    â”‚  â”‚  â”‚Node 1â”‚  â”‚Node 2â”‚  â”‚Node 3â”‚           â”‚  â”‚
    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜           â”‚  â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
